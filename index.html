<!DOCTYPE html>
<head>
  <script>

  </script>
  <script src="js/chromebookcheck.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/BranchUni.js"></script>
  <script src="js/background-switcher.js"></script>
  <script src="js/theme-switcher.js"></script>
  <link rel="stylesheet" href="css/theme-index.css">
  <title>Shatter</title>
  <link rel="stylesheet" href="css/login.css">
  <script src="js/achivements.js"></script>
  <script src="textsplash.js" onload="changeText()"></script>
  <script src="js/UpdateValues.js"></script>
  <script src="js/lastpage.js"></script>
  <script src="js/MainMaster.js"></script>
  <script src="js/ErudaConsole.js"></script>
  <script src="js/Lobotomy.js"></script>
  <script src="js/BanLogout.js"></script>
  <script src="js/Notif.js"></script>
  <script src="js/Shutdown.js"></script>
  <script src="js/cloakpage.js"></script>
  <script src="js/AntiTabClose.js"></script>
  <script src="js/textsplash.js" onload="changeText()"></script>
  <script src="js/earn-achievements.js"></script>
  <script src="js/secret.js"></script>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="css/crt.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/MusicSystem.css">
  <script src="js/MusicSystem.js"></script>
<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="manifest.json">
<script src="js/UpdateValues.js"></script>
  <script>
	//window.location.replace("./Placeholder.html")
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('pwabuilder-sw.js')
        .then((registration) => {
          console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
    }
  </script>
  <script>
// Frequent User Achievement Script
function trackFrequentUser() {
    let visits = parseInt(localStorage.getItem('siteVisits') || '0');
    visits++;
    localStorage.setItem('siteVisits', visits);
    localStorage.setItem('achievement_frequent_user', visits >= 30);
}

// Run this function when the page loads
document.addEventListener('DOMContentLoaded', trackFrequentUser);
  </script>
  <script>
    // Konami Code sequence
const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
let konamiIndex = 0;

function handleKonamiCode(event) {
    if (event.key === konamiCode[konamiIndex]) {
        konamiIndex++;
        if (konamiIndex === konamiCode.length) {
            localStorage.setItem('achievement_easter_egg_2', true);
            konamiIndex = 0; // Reset for future attempts
            alert('Easter Egg Found!');
        }
    } else {
        konamiIndex = 0;
    }
}

document.addEventListener('keydown', handleKonamiCode);
  </script>
</head>
<body class="dark-theme" onload="changeText()">
  <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Get the current URL
        var currentURL = window.location.href;
        document.getElementById("url-target").value = currentURL;
    });
</script>
</body>
<div class="floating-element">
    <p id="fractureVersionNumber" style="margin: 0;">7.0.0</p>
</div>
<br>
<script>
changeText();
</script>
<style>
  body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f4;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 90vh;
            margin: 0;
        }

.floating-element {
  position: fixed;
bottom: 0.625rem;
right: 0.625rem;
background: var(--color-major);
border: 1px solid var(--color-border);
padding: 0.625rem;
border-radius: 0.3125rem;
backdrop-filter: blur(4px);
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
transition: all 0.2s ease;
}

  body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .container5 {
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
    position: absolute;
    top: 100px; /* Default value for larger screens */

    /* Adjust top position for smaller screens */
    @media screen and (max-width: 768px) {
        top: 80px;
    }

    @media screen and (max-width: 480px) {
        top: 60px;
    }

    @media screen and (max-width: 320px) {
        top: 40px;
    }
}


.resizable-image {
    width: 100%;
    height: auto;
            margin: 0;
            display: flex;
            align-items: center;
}



</style>
    <div class="container5" id="container5">
        <img src="Fracture-Minecraft_Title.png" alt="Resizable Image" class="resizable-image">
<h3 id="random-h1">Loading Text</h3>
    </div>
<br>
  <style>

.background {
  background: var(--color-major);
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -5;
}

#navcontainer, #navcontainer2 {
  position: absolute;
  top: 60%;
  left: 50%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  border: 2px solid var(--color-accent);
  animation: changeBorderRadius 1s 1;
  display: flex;
  justify-content: center;
  align-items: center;
}

#navcontainer {
  width: 300px;
  height: 300px;
}

#navcontainer2 {
  width: 150px;
  height: 150px;
}

.vbutton, .console-button, .ab-cloak-button {
  position: absolute;
  width: 80px;
  height: 40px;
  background-color: var(--color-minor);
  color: white;
  border: 2px solid var(--color-accent);
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  line-height: 40px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 16px;
  font-weight: bold;
  text-decoration: none;
  transition: all 0.3s ease-in-out;
}

.vbutton:hover, .console-button:hover, .ab-cloak-button:hover {
  border-radius: 10px;
  border-color: var(--color-button-hover);
  background-color: var(--color-accent-hover);
  color: #fff;
}

#create { top: 50%; left: 50%; transform: translate(-50%, -50%); }
#navbutton2 { top: -5%; left: 50%; transform: translateX(-50%); }
#navbutton3 { top: 92%; left: 50%; transform: translateX(-50%); }
#navbutton4 { top: 50%; left: -10%; transform: translateY(-50%); }
#navbutton5 { top: 50%; left: 80%; transform: translateY(-50%); }
#navbutton7 { top: 18%; left: 76%; transform: translateY(-50%); }
#navbutton8 { top: 72%; left: 10%; transform: translateX(-50%); }
#navbutton9 { top: 18%; left: -4%; transform: translateY(-50%); }
#navbutton10 { top: 80%; left: 76%; transform: translateY(-50%); }
#adminpan { top: 50%; left: -76%; transform: translateY(-50%); }

.a-fix {
  display: inline-flex;
  justify-content: center; 
  align-items: center;
  text-align: center;
  height: 100%; 
  width: 100%;
}

@keyframes changeBorderRadius {
  0% { border-radius: 0; }
  100% { border-radius: 50%; }
}

.warn-warning-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--color-minor-lesser);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.warn-warning-container {
  background: var(--color-major);
  padding: 2rem;
  border-radius: 8px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 4px 15px rgba(153, 0, 255, 0.2);
  border: 1px solid var(--color-accent2);
}

.warn-warning-title {
  color: var(--color-accent2);
  font-size: 1.5rem;
  font-weight: bold;
  margin-bottom: 1rem;
  text-align: center;
}

.warn-warning-description {
  color: var(--color-text-light);
  margin-bottom: 1.5rem;
  line-height: 1.5;
}

.warn-dismiss-button {
  background: var(--color-button);
  color: var(--color-text-light);
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.2s;
  width: 100%;
}

.warn-dismiss-button:hover {
  background: var(--color-button-hover);
  transform: translateY(-2px);
}

.a-notification {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background: var(--color-major);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 15px 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    display: none;
    animation: slideIn 0.3s ease-out;
    z-index: 1000;
    min-width: 150px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: var(--color-text);
}

@keyframes slideIn {
    from {
        transform: translateY(100px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.a-notification.show {
    display: flex;
}

.a-notification p {
    margin: 0;
    margin-right: 15px;
}

.btn-group {
    display: flex;
    gap: 10px;
}

.btn {
    padding: 8px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
}

.btn-yes {
    background-color: var(--color-button);
    color: var(--color-text);
}

.btn-yes:hover {
    background-color: var(--color-button-hover);
}

.btn-no {
    background-color: var(--color-major-lesser);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-no:hover {
    background-color: var(--color-minor-lesser);
}

.backup-progress {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--color-major);
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.4);
    display: none;
    color: var(--color-text);
    border: 1px solid var(--color-border);
    min-width: 300px;
}

.progress-bar {
    width: 100%;
    height: 10px;
    background: var(--color-major-lesser);
    border-radius: 5px;
    overflow: hidden;
    margin: 10px 0;
}

.progress-fill {
    width: 0%;
    height: 100%;
    background: var(--color-button);
    transition: width 0.3s ease;
}
  </style>
<div class="full-page-div" id="loginDiv">
        <div>
            <h1>Shatter Login</h1>
            <p>If you want a login, make a request for one <a href="LoginForm.html" style="color: lightblue;">here</a>.</p>
        </div>
        <br>
        <div class="login-container">
            <input type="text" autocomplete="off" placeholder="Username" id="username">
            <input type="password" autocomplete="off" placeholder="Password" id="password">
	
            <button id="loginButton" onclick="login()">Login</button>
            <!--  <button id="loginButton" onclick="loginGuest()">Guest</button>  -->
            <p id="errorMessage" class="error-message"></p>
        </div>
    </div>
<div class="container">
  <img src="Icons/Loading.gif" alt="Profile Picture" class="profile-picture" id="profilePicture">
  <div class="name" id="name">Name</div>
  <div class="premium-status" id="premiumStatus"></div>
  <button class="logout-button" onclick="logout()">Logout</button>
</div>
  <div id="navcontainer3">
  </div>
  <div id="navcontainer2">
  </div>
  <div id="navcontainer">
  <a hidden id="create" class="console-button" class="button" href="#">Cloak</a>
  <a id="navbutton2" class="vbutton" href="google-classroom.html">Games</a>
  <a id="navbutton3" class="vbutton" href="google-drive.html">Extras</a>
  <a id="navbutton8" class="vbutton" href="Addons.html">Addons</a>
  <a id="navbutton4" class="vbutton" href="chat.html">Frat-Chat</a>
  <a id="navbutton7" class="vbutton" href="About.html">About</a>
  <a id="navbutton10" class="vbutton" href="LinkWeb.html">LinkWeb</a>
  <a  style="font-size: 15px;" id="navbutton9" class="vbutton" href="settings.html">Settings</a>
  <a style="font-size: 12px;" id="navbutton5" class="vbutton" href="Launchpad.html">Leaderboard</a>
<a style="top: 50%; left: 50%; transform: translate(-50%, -50%);" id="ab-cloak-button" class="ab-cloak-button">Cloak</a>
<p hidden class="console-input"><input id="url-target" value="https://graystuido.github.io/Fracture/" autocomplete="on" type="text" autofocus /></p>
<a id="adminpan" class="vbutton" href="AdminPanel.html">Admin</a>
</div>

<script src="js/AdminPanel.js"></script>




<style>
body {
color: white;
background: var(--color-background);
margin: 0;
padding: 0;
}
		@font-face {
  font-family: 'Lexend Semi-Bold';
  src: url('path/to/lexend-semibold.woff2') format('woff2'), /* Modern Browsers */
       url('path/to/lexend-semibold.woff') format('woff'); /* Older Browsers */
  font-weight: 600; /* Specify the font weight */
  font-style: normal; /* Specify the font style */
}
body {
    font-family: 'lexend-semibold', sans-serif;
}
</style>
<script src="cloak.js">
      var url = document.getElementById("url-target");
      var urlObj = new window.URL(window.location.href);
      document.getElementById("create").onclick = function () {
        if (url.value.substring(0, 8) !== 'https://' && url.value.substring(0, 7) !== 'http://') {
    		url.value = 'https://' + url.value.split('https://').pop();
        } else if (url.value.substring(0, 7) == 'http://'){
        	url.value = 'https://' + url.value.split('http://').pop();
        };
        win = window.open('about:blank', 'about:blank', 'height=600,width=800,resizable=no,scrollbars=no,status=no,toolbar=no,location=no,menubar=no');
        win.document.body.style.margin = "0";
        win.document.body.style.height = "100vh";
        var iframe = win.document.createElement("iframe");
        iframe.style.border = "none";
        iframe.style.width = "100%";
        iframe.style.height = "100%";
        iframe.style.margin = "0";
        iframe.referrerpolicy = "no-referrer";
        iframe.allow = "fullscreen";
        iframe.src = url.value;
        win.document.body.appendChild(iframe);
      };
</script>

    <script>
      // Main cloaking function that can be called externally
function initializeCloak(buttonId = "ab-cloak-button") {
    // Check if we're in an iframe or about:blank
    function shouldPreventCloak() {
        try {
            // Check if we're in an iframe
            if (window !== window.top) return true;
            
            // Check if we're on about:blank
            if (window.location.href === "about:blank") return true;
            
            return false;
        } catch (error) {
            // If we can't access window.top due to cross-origin,
            // we're probably in an iframe
            return true;
        }
    }

    // Don't initialize if we're in an iframe or about:blank
    if (shouldPreventCloak()) {
        console.debug("Cloak initialization prevented: page is in iframe or about:blank");
        return;
    }

    function cloakPage(targetUrl) {
        try {
            var win = window.open('about:blank', 'about:blank', 'height=800,width=1080,resizable=no,scrollbars=no,status=no,toolbar=no,location=no,menubar=no');
            if (!win) throw new Error("Popup blocked");
            
            win.document.body.style.margin = "0";
            win.document.body.style.height = "100vh";
            
            var iframe = win.document.createElement("iframe");
            iframe.style.border = "none";
            iframe.style.width = "100%";
            iframe.style.height = "100%";
            iframe.style.margin = "0";
            iframe.referrerpolicy = "no-referrer";
            iframe.allow = "fullscreen";
            iframe.src = targetUrl;
            
            win.document.body.appendChild(iframe);
            window.close();
            return true;
        } catch (error) {
            console.error("Error in cloaking process:", error);
            return false;
        }
    }

    function attachCloakHandler(element) {
        element.onclick = function() {
            var url;
            try {
                url = window.location.href;
            } catch (error) {
                console.error("Error getting current URL:", error);
                url = "https://graystuido.github.io/Fracture/index.html";
            }
            return cloakPage(url);
        };
    }

    // Create invisible overlay for click handling if needed
    function createClickOverlay() {
        var overlay = document.createElement('div');
        overlay.style.position = 'fixed';
        overlay.style.top = '0';
        overlay.style.left = '0';
        overlay.style.width = '100%';
        overlay.style.height = '100%';
        overlay.style.backgroundColor = 'transparent';
        overlay.style.zIndex = '2147483647'; // Maximum z-index
        overlay.style.cursor = 'pointer';
        
        overlay.onclick = function() {
            var url = window.location.href;
            cloakPage(url);
            document.body.removeChild(overlay);
        };
        
        document.body.appendChild(overlay);
    }

    // Initialize when DOM is ready
    function initialize() {
        try {
            var button = document.getElementById(buttonId);
            if (button) {
                attachCloakHandler(button);
            } else {
                throw new Error("Button not found");
            }
        } catch (error) {
            console.warn("Falling back to click overlay:", error);
            createClickOverlay();
        }
    }

    // Handle both DOMContentLoaded and load events
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initialize);
    } else {
        initialize(); // DOM is already ready
    }

    // Backup initialization if DOMContentLoaded fails
    window.addEventListener("load", function() {
        var button = document.getElementById(buttonId);
        if (!button || !button.onclick) {
            initialize();
        }
    });
}

// Export functions for external use if we're not in an iframe/about:blank
if (!shouldPreventCloak()) {
    window.initializeCloak = initializeCloak;
    window.cloakPage = cloakPage;
    
    // Auto-initialize with default button ID
    initializeCloak();
}
    </script>


    <script>
      document.getElementById("ab-cloak-button").onclick = function () {
    var url;
    try {
        url = window.location.href;
    } catch (error) {
        console.error("Error getting current URL:", error);
        url = "https://graystudio.github.io/Fracture/index.html";
    }

    var win = window.open('about:blank', 'about:blank', 'height=800,width=1080,resizable=no,scrollbars=no,status=no,toolbar=no,location=no,menubar=no');
    win.document.body.style.margin = "0";
    win.document.body.style.height = "100vh";
    var iframe = win.document.createElement("iframe");
    iframe.style.border = "none";
    iframe.style.width = "100%";
    iframe.style.height = "100%";
    iframe.style.margin = "0";
    iframe.referrerpolicy = "no-referrer";
    iframe.allow = "fullscreen";
    iframe.src = url;
    win.document.body.appendChild(iframe);

    // Attempt to close the current tab
    var closed = window.close();
    if (!closed) {
        // If window.close() fails, redirect to Google
        window.location.href = "about:blank";
    }
};
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
    // Check if we're in an iframe or about:blank
    if (window.location.href === "about:blank" || window !== window.top) {
        return; // Do not run if in an iframe or about:blank
    }

    // Check if installed in localStorage
    if (localStorage.getItem('autoab') !== 'installed') {
        return; // Exit if not installed
    }

    // Function to run the cloak operation
    function runCloak() {
        var url;
        try {
            url = window.location.href;
        } catch (error) {
            console.error("Error getting current URL:", error);
            url = "https://graystudio.github.io/Fracture/index.html";
        }
        
        var win = window.open('about:blank', 'about:blank', 'height=800,width=1080,resizable=no,scrollbars=no,status=no,toolbar=no,location=no,menubar=no');
        win.document.body.style.margin = "0";
        win.document.body.style.height = "100vh";
        var iframe = win.document.createElement("iframe");
        iframe.style.border = "none";
        iframe.style.width = "100%";
        iframe.style.height = "100%";
        iframe.style.margin = "0";
        iframe.referrerpolicy = "no-referrer";
        iframe.allow = "fullscreen";
        iframe.src = url;
        win.document.body.appendChild(iframe);

        // Attempt to close the current tab
        var closed = window.close();
        if (!closed) {
            // If window.close() fails, redirect to Google
            window.location.href = "about:blank";
        }
    }

    // Create invisible overlay
    var overlay = document.createElement('div');
    overlay.style.position = 'fixed';
    overlay.style.top = '0';
    overlay.style.left = '0';
    overlay.style.width = '100%';
    overlay.style.height = '100%';
    overlay.style.zIndex = '999999';
    overlay.style.cursor = 'default';
    overlay.style.opacity = '0';
    document.body.appendChild(overlay);

    // Add click handler to the overlay
    overlay.addEventListener('click', runCloak);
});
    </script>



    <script>
    function checkFirstVisit() {
      if (!localStorage.getItem('hasVisited')) {
        const overlay = document.createElement('div');
        overlay.className = 'warn-warning-overlay';
        
        const container = document.createElement('div');
        container.className = 'warn-warning-container';
        
        const title = document.createElement('div');
        title.className = 'warn-warning-title';
        title.textContent = 'DON\'T SEND THIS WEBSITE OVER EMAIL';
        
        const description = document.createElement('div');
        description.className = 'warn-warning-description';
        description.textContent = 'This website will be blocked if sent to and from any name@nclack.org email, spread through word of mouth or a secure channel.';
        
        const button = document.createElement('button');
        button.className = 'warn-dismiss-button';
        button.textContent = 'I Understand';
        
        button.addEventListener('click', () => {
          overlay.remove();
          localStorage.setItem('hasVisited', 'true');
        });
        
        container.appendChild(title);
        container.appendChild(description);
        container.appendChild(button);
        overlay.appendChild(container);
        document.body.appendChild(overlay);
      }
    }

    window.addEventListener('load', checkFirstVisit);
  </script>




  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @keyframes breathing {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    #random-h1 {
      display: inline-block;
      animation: breathing 3s infinite ease-in-out;
    }
  </style>
 <script>
      window.onload = function(MatrixBackground) {
        const canvas = document.getElementById('MatrixBackground');
        const chars = 'abcdefgyzhijklmnopQRSTUVABCDEFGYZ109467ﾊﾐﾋｰｳｼﾅﾓﾆｻﾜﾂｵﾘｱﾎﾃﾏｹﾒｴｶｷﾑﾕﾗｾﾈｽﾀﾇﾍ日¦｜:・."=*+-<>'; // Your chosen characters
        const duration = 10000; // Duration of the matrix effect in milliseconds

        // Get canvas context and set canvas size
        const ctx = canvas.getContext('2d');
        const w = canvas.width = window.innerWidth;
        const h = canvas.height = window.innerHeight;

        // Calculate number of columns and initialize y positions
        const cols = Math.floor(w / 20) + 1;
        const ypos = Array(cols).fill(0);

        // Fill canvas with black color
        ctx.fillStyle = '#000';
        ctx.fillRect(0, 0, w, h);

        // Create matrix effect function
        const matrix = () => {
          ctx.fillStyle = '#0001';
          ctx.fillRect(0, 0, w, h);

          ctx.fillStyle = '#C800FF';
          ctx.font = '15pt monospace';

          ypos.forEach((y, ind) => {
            const text = chars[Math.floor(Math.random() * chars.length)];
            const x = ind * 20;
            ctx.fillText(text, x, y);
            if (y > 100 + Math.random() * 10000) ypos[ind] = 0;
            else ypos[ind] = y + 20;
          });
        };

        // Call matrix effect function every 50 milliseconds
        const matrixInterval = setInterval(matrix, 50);
      };
    </script>
<div id="center-bar"></div>
<div class="background">
  <canvas id="MatrixBackground"></canvas>
</div>
<style>
        .full-page-div {
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            flex-direction: column;
            position: relative;
            z-index: 9998;
        }
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .login-container input {
            padding: 10px;
            margin: 5px 0;
            width: 200px;
            border: none;
            border-radius: 5px;
        }
        .login-container button {
            padding: 10px;
            margin-top: 10px;
            width: 220px;
            max-width: 220px;
            border: none;
            border-radius: 5px;
            background-color: #333;
            color: white;
            cursor: pointer;
        }
        .login-container button:hover {
            background-color: #555;
        }
        .error-message {
            color: red;
            margin-top: 10px;
            display: none;
        }
        .error-button {
            background-color: red;
        }
    </style>
    <script src="./js/ext-db.js"></script>
    <script src="LoginFile.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
          const storedUsername = localStorage.getItem('loggedInUser');
          const isPremium = localStorage.getItem('premium');
          let profilePicturePath = localStorage.getItem('profilePicture') || 'Placeholder.png';
      
          // Check if the profile picture path is valid
          const img = new Image();
          img.onload = function() {
              document.getElementById('profilePicture').src = profilePicturePath;
          };
          img.onerror = function() {
              profilePicturePath = 'UserImages/Placeholder.png';
              document.getElementById('profilePicture').src = profilePicturePath;
          };
          img.src = profilePicturePath;
      
          if (storedUsername) {
              document.getElementById('name').textContent = storedUsername;
      
              const premiumStatusElement = document.getElementById('premiumStatus');
            if (isUserAdmin()) {
                premiumStatusElement.textContent = 'Admin';
                premiumStatusElement.classList.add('Admin');
            }
            else {
              if (isPremium === 'true') {
                  premiumStatusElement.textContent = 'Verified Account';
                  premiumStatusElement.classList.add('premium');
              } else {
                  premiumStatusElement.textContent = 'Standard Account';
                  premiumStatusElement.classList.add('non-premium');
              }
            }
          }
      });
      
      function logout() {
          localStorage.removeItem('loggedInUser');
          localStorage.removeItem('premium');
          localStorage.removeItem('profilePicture');
          location.reload();
      }
          </script>

<div id="termsContainer" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 20px; background-color: #2b2b2b; border: 1px solid #ffffff; width: 80%; max-width: 800px; height: 80%; max-height: 600px; overflow-y: auto; text-align: justify; z-index: 9999; box-sizing: border-box;">
  <h2>Terms and Conditions</h2>
  <p>
      By accessing and using our website, you agree to comply with the following terms and conditions:
  </p>
  <ol>
      <li><strong>Acceptance of Terms:</strong> By accessing or using Fracture, you acknowledge that you have read, understood, and agree to be bound by these Terms and Agreements. If you do not agree with any part of these terms, please refrain from using our website.</li>
      <br>
      <li><strong>Limitation of Liability:</strong> Fracture and its staff, affiliates, and associates shall not be held liable for any direct, indirect, incidental, special, consequential, or punitive damages arising out of your access to, or use of, our website. This includes, but is not limited to, damages for loss of profits, goodwill, use, data, or other intangible losses.</li>
      <br>
      <li><strong>User Responsibility:</strong> Users agree to take sole responsibility for any academic losses or any other consequences that may arise from the use of our website. Fracture and its staff are not responsible for any academic or personal consequences resulting from the use of our services.</li>
      <br>
      <li><strong>Intellectual Property:</strong> All content on Fracture, including but not limited to text, graphics, logos, images, audio clips, video clips, digital downloads, and software, is the property of Fracture or its content suppliers and is protected by United States and international copyright laws.</li>
      <br>
      <li><strong>Compliance with School Policies:</strong> Teachers and school staff within Clackamas Highschool and NCSD (North Clackamas School District) reserve the right to request the immediate halting and operation of the website by contacting us through our support email: fracture.contact@aol.com. We will promptly address any concerns raised by educational institutions and comply with their requests.</li>
      <br>
      <li><strong>Changes to Website:</strong> Fracture reserves the right to modify, suspend, or discontinue any aspect of the website at any time, including the availability of any features, databases, or content. Users acknowledge and agree that Fracture shall not be liable to you or any third party for any modification, suspension, or discontinuance of the website.</li>
      <br>
      <li><strong>Governing Law:</strong> These Terms and Agreements shall be governed by and construed in accordance with the laws of the state of Oregon, USA. Any disputes arising out of or relating to these terms shall be subject to the exclusive jurisdiction of the state and federal courts located in Multnomah County, Oregon.</li>
      <br>
      <li><strong>Contact Information:</strong> If you have any questions or concerns regarding these Terms and Agreements, please contact us at fracture.contact@aol.com.</li>
  </ol>
  <button id="acceptButton" style="padding: 10px 20px; background-color: #007bff; color: #ffffff; border: none; cursor: pointer;">Accept</button>
</div>



<script>
document.getElementById('acceptButton').addEventListener('click', function() {
  var termsContainer = document.getElementById('termsContainer');
  termsContainer.style.transition = 'opacity 1s';
  termsContainer.style.opacity = '0';
  termsContainer.style.pointerEvents = 'none';
  
  // Store the agreement status in local storage
  localStorage.setItem('TermsAgreedTo', 'true');
});
</script>

<script>
// Check if the user has previously agreed to the terms
window.onload = function() {
  var agreed = localStorage.getItem('TermsAgreedTo');
  if (agreed !== 'true') {
      var termsContainer = document.getElementById('termsContainer');
      termsContainer.style.display = 'block';
  }
};
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const BACKUP_INTERVAL_DAYS = 5;
    const STORAGE_KEY = 'nextBackupDate';
    
    // Function to check if backup is due
    function isBackupDue() {
        const nextBackupDate = localStorage.getItem(STORAGE_KEY);
        if (!nextBackupDate) return true;
        
        const nextDate = new Date(nextBackupDate);
        const currentDate = new Date();
        return currentDate >= nextDate;
    }
    
    // Function to set next backup date
    function setNextBackupDate() {
        const nextDate = new Date();
        nextDate.setDate(nextDate.getDate() + BACKUP_INTERVAL_DAYS);
        localStorage.setItem(STORAGE_KEY, nextDate.toISOString());
    }
    
    // Initialize UI elements
    const notification = document.createElement('div');
    notification.id = 'backupNotification';
    notification.className = 'a-notification';
    
    const text = document.createElement('p');
    text.textContent = 'Backup Data';
    
    const btnGroup = document.createElement('div');
    btnGroup.className = 'btn-group';
    
    const yesBtn = document.createElement('button');
    yesBtn.className = 'btn btn-yes';
    yesBtn.textContent = 'Click';
    
    // Assemble UI elements
    btnGroup.appendChild(yesBtn);
    btnGroup.appendChild(noBtn);
    notification.appendChild(text);
    notification.appendChild(btnGroup);
    
    // Create backup progress UI
    const backupProgress = document.createElement('div');
    backupProgress.id = 'backupProgress';
    backupProgress.className = 'backup-progress';
    
    const heading = document.createElement('h3');
    heading.textContent = 'Backing up data...';
    
    const progressBar = document.createElement('div');
    progressBar.className = 'progress-bar';
    const progressFill = document.createElement('div');
    progressFill.id = 'progressBar';
    progressFill.className = 'progress-fill';
    progressBar.appendChild(progressFill);
    
    const statusText = document.createElement('p');
    statusText.id = 'statusText';
    
    const errorMessage = document.createElement('p');
    errorMessage.id = 'errorMessage';
    errorMessage.style.color = 'var(--color-uninstall)';
    
    backupProgress.appendChild(heading);
    backupProgress.appendChild(progressBar);
    backupProgress.appendChild(statusText);
    backupProgress.appendChild(errorMessage);
    
    document.body.appendChild(notification);
    document.body.appendChild(backupProgress);
    
    // Initialize UI update functions
    const updateUI = (() => {
        const statusTextEl = document.getElementById('statusText');
        const progressBarEl = document.getElementById('progressBar');
        const errorMessageEl = document.getElementById('errorMessage');
        
        return {
            status: (message, progress = null) => {
                statusTextEl.textContent = message;
                if (progress !== null) {
                    progressBarEl.style.width = `${progress}%`;
                }
            },
            error: (message) => {
                errorMessageEl.textContent = message;
            },
            reset: () => {
                statusTextEl.textContent = '';
                progressBarEl.style.width = '0%';
                errorMessageEl.textContent = '';
            }
        };
    })();
    
    // Event handlers
    function handleBackupNo() {
        setNextBackupDate();
        notification.classList.remove('show');
    }
    
    async function handleBackupYes() {
        notification.classList.remove('show');
        backupProgress.style.display = 'block';
        
        try {
            await exportLocalStorage(updateUI);
            setNextBackupDate();
            
            setTimeout(() => {
                backupProgress.style.display = 'none';
                updateUI.reset();
            }, 2000);
        } catch (error) {
            console.error('Backup failed:', error);
            updateUI.error(`Backup failed: ${error.message}`);
        }
    }
    
    // Attach event handlers
    yesBtn.onclick = () => handleBackupYes();
    noBtn.onclick = handleBackupNo;
    
    // Check if backup is due and show notification if needed
    if (isBackupDue()) {
        notification.classList.add('show');
    }
});

// Utility functions remain the same
const getCurrentDateTime = () => new Date().toISOString().replace(/[-:T.]/g, '').slice(0, 14);

const processInChunks = async (items, processItem, updateProgress) => {
    const chunkSize = 100;
    const totalItems = items.length;

    for (let i = 0; i < totalItems; i += chunkSize) {
        const chunk = items.slice(i, Math.min(i + chunkSize, totalItems));
        await Promise.all(chunk.map(processItem));
        updateProgress(Math.min(i + chunkSize, totalItems), totalItems);
        await new Promise(resolve => setTimeout(resolve, 0));
    }
};

const exportLocalStorage = async (updateUI) => {
    updateUI.status('Preparing export...', 0);
    updateUI.error('');

    try {
        const keys = Object.keys(localStorage);
        const totalItems = keys.length;
        const localStorageData = {};

        await processInChunks(
            keys,
            async (key) => {
                localStorageData[key] = localStorage.getItem(key);
            },
            (processed, total) => {
                updateUI.status(`Exporting... ${processed}/${total}`, (processed / total) * 100);
            }
        );

        const blob = new Blob([JSON.stringify(localStorageData)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `backup-${getCurrentDateTime()}.json`;
        a.click();
        URL.revokeObjectURL(url);

        updateUI.status('Export Complete!', 100);
    } catch (error) {
        console.error('Export error:', error);
        updateUI.status('Export Failed!', 0);
        updateUI.error(`Error: ${error.message}`);
        throw error;
    }
};
  </script>
